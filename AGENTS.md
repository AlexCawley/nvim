# Agent Guide for Neovim Configuration Management

This guide provides instructions for AI agents and assistants working with this Neovim configuration. It outlines the structure, conventions, and best practices for managing plugins and configuration files.

## Configuration Architecture

### Directory Structure
```
nvim/
├── init.lua                     # Entry point - loads core and plugins
├── lua/
│   ├── core/                   # Core configuration modules
│   │   ├── init.lua            # Loads options and keymaps
│   │   ├── options.lua         # Vim settings and global options
│   │   └── keymaps.lua         # Basic key mappings
│   ├── setup/                  # Cross-platform utilities
│   │   ├── init.lua            # Setup commands loader
│   │   └── roslyn.lua          # Roslyn LSP setup utilities
│   └── plugins/                # Plugin configurations
│       ├── init.lua            # Packer plugin manager setup
│       └── [plugin].lua        # Individual plugin configurations
└── plugin/
    └── packer_compiled.lua     # Auto-generated by Packer
```

## Plugin Management Guidelines

### Package Manager: Packer.nvim
- **Main file**: `lua/plugins/init.lua`
- **Installation**: Auto-installs if missing via `init.lua`
- **Plugin directory**: `%LOCALAPPDATA%\nvim-data\site\pack\packer\start\`

### Adding New Plugins

1. **Add plugin declaration** in `lua/plugins/init.lua`:
   ```lua
   use {
       'author/plugin-name',
       config = require('plugins.plugin-name') -- Optional config file
   }
   ```

2. **Create configuration file** (if needed) at `lua/plugins/plugin-name.lua`:
   ```lua
   return function()
       require('plugin-name').setup({
           -- plugin configuration
       })
   end
   ```

3. **Install plugin**: Run `:PackerSync` in Neovim

### Plugin Configuration Patterns

#### Simple Plugin (no configuration)
```lua
use 'author/simple-plugin'
```

#### Plugin with Inline Configuration
```lua
use {
    'author/plugin-name',
    config = function()
        require('plugin-name').setup({
            option = value
        })
    end
}
```

#### Plugin with External Configuration File
```lua
use {
    'author/plugin-name',
    config = require('plugins.plugin-name')
}
```

#### Plugin with Dependencies
```lua
use {
    'author/main-plugin',
    requires = { 'author/dependency' },
    config = require('plugins.main-plugin')
}
```

## Configuration Modification Guidelines

### When Modifying Plugin Configurations

1. **Read existing configuration** first to understand current setup
2. **Follow established patterns** in the codebase
3. **Maintain consistency** with existing key mappings and options
4. **Test changes** by restarting Neovim or reloading configuration

### Key Mapping Conventions

- **Leader key**: `<space>` (configured in `options.lua`)
- **Plugin-specific mappings**: Defined in respective plugin config files
- **Core mappings**: Defined in `core/keymaps.lua`

## Modification Workflow

### For AI Agents
1. **Analyze current structure** before making changes
2. **Use existing patterns** and conventions
3. **Test configuration** after modifications
4. **Document changes** in README.md if adding significant features
5. **Preserve user customizations** and preferences

### Adding Language Support
1. **Add language server** to mason-lspconfig ensure_installed list
2. **Configure LSP** in `lspconfig.lua` if custom setup needed
3. **Add formatters** to `conform.lua` if formatting support desired
4. **Update documentation** if new key mappings are added

### File Modification Priority
1. **Plugin configs**: Modify existing plugin configuration files
2. **Core settings**: Modify `core/options.lua` or `core/keymaps.lua`
3. **New plugins**: Add to `plugins/init.lua` and create config files
4. **Documentation**: Update README.md with significant changes

## Best Practices for Agents

### DO:
- Read existing configuration before making changes
- Follow established naming conventions
- Use protected calls for error handling
- Test changes by suggesting user restart Neovim
- Maintain backward compatibility with existing key mappings
- Keep configurations modular and organized

### DON'T:
- Remove existing functionality without user request
- Break established key mapping patterns
- Create complex nested configurations without justification
- Ignore existing error handling patterns
- Modify auto-generated files (like `packer_compiled.lua`)
- Add plugins without clear benefit or user request

## File Change Impact

- **`init.lua`**: Affects entire configuration loading
- **`core/`**: Affects basic Neovim behavior and key mappings
- **`plugins/init.lua`**: Affects plugin availability and loading
- **`plugins/[name].lua`**: Affects specific plugin behavior
- **`setup/`**: Affects cross-platform utilities and commands

Always consider the scope of changes and test thoroughly before considering the modification complete.
